<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Security Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        /* Custom scrollbar for better aesthetics */
        textarea::-webkit-scrollbar { width: 8px; }
        textarea::-webkit-scrollbar-thumb { background-color: #9ca3af; border-radius: 4px; }
        textarea::-webkit-scrollbar-track { background-color: #e5e7eb; }
    </style>
</head>
<body class="min-h-screen p-4 sm:p-8 flex items-start justify-center">

    <!-- Main Application Container -->
    <div id="app" class="w-full max-w-4xl bg-white shadow-2xl rounded-xl overflow-hidden transform transition duration-500 ease-in-out">

        <!-- Header -->
        <header class="p-6 border-b border-gray-100 bg-indigo-600 text-white">
            <h1 class="text-3xl font-bold tracking-tight">ðŸ”’ Security Hub Pro</h1>
            <p class="text-indigo-200 mt-1 text-sm">Cipher Tools, Security Analysis, and AI Assistance</p>
        </header>

        <!-- Tabs Navigation -->
        <nav class="flex border-b border-gray-200">
            <button id="tab-crypto" onclick="showTab('crypto')" class="tab-button flex-1 py-3 px-2 text-center font-medium text-sm sm:text-lg border-b-2 transition duration-150 ease-in-out" data-tab="crypto">
                Ciphers
            </button>
            <button id="tab-analysis" onclick="showTab('analysis')" class="tab-button flex-1 py-3 px-2 text-center font-medium text-sm sm:text-lg border-b-2 transition duration-150 ease-in-out" data-tab="analysis">
                Analysis
            </button>
            <button id="tab-password" onclick="showTab('password')" class="tab-button flex-1 py-3 px-2 text-center font-medium text-sm sm:text-lg border-b-2 transition duration-150 ease-in-out" data-tab="password">
                Password AI
            </button>
            <button id="tab-explainer" onclick="showTab('explainer')" class="tab-button flex-1 py-3 px-2 text-center font-medium text-sm sm:text-lg border-b-2 transition duration-150 ease-in-out" data-tab="explainer">
                Explainer AI
            </button>
        </nav>

        <!-- Content Area -->
        <main class="p-6 sm:p-8">

            <!-- Tab 1: Encryption & Decryption (Ciphers) -->
            <section id="crypto-tab" class="tab-content space-y-6 hidden">
                <h2 class="text-2xl font-semibold text-gray-800 border-b pb-2 mb-4">Classic Ciphers</h2>
                
                <!-- Input/Output Textareas -->
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label for="crypto-input" class="block text-sm font-medium text-gray-700 mb-2">Input Text</label>
                        <textarea id="crypto-input" rows="8" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150" placeholder="Enter text to encrypt/decrypt..."></textarea>
                    </div>
                    <div>
                        <label for="crypto-output" class="block text-sm font-medium text-gray-700 mb-2">Output Text</label>
                        <textarea id="crypto-output" rows="8" class="w-full p-3 border border-gray-300 rounded-lg bg-gray-50 resize-none transition duration-150" readonly placeholder="Result will appear here..."></textarea>
                    </div>
                </div>

                <!-- Cipher Selection and Controls -->
                <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                    <div class="flex flex-wrap gap-4 items-center mb-4">
                        <label class="text-sm font-medium text-gray-700">Select Cipher:</label>
                        
                        <div class="flex flex-wrap items-center gap-x-4">
                            <label><input type="radio" name="cipher" value="rot" checked onchange="updateCipherControls()" class="mr-1 accent-indigo-600"> ROT-N</label>
                            <label><input type="radio" name="cipher" value="base64" onchange="updateCipherControls()" class="mr-1 accent-indigo-600"> Base64</label>
                            <label><input type="radio" name="cipher" value="vigenere" onchange="updateCipherControls()" class="mr-1 accent-indigo-600"> VigenÃ¨re</label>
                        </div>
                    </div>
                    
                    <div id="rot-control" class="flex items-center space-x-3 mb-4">
                        <label for="rot-shift" class="text-sm font-medium text-gray-700">ROT Shift (1-25):</label>
                        <input type="number" id="rot-shift" value="13" min="1" max="25" class="w-20 p-2 border border-gray-300 rounded-lg text-center focus:ring-indigo-500 focus:border-indigo-500">
                    </div>

                    <!-- VigenÃ¨re Control Section -->
                    <div id="vigenere-control" class="hidden bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-3 rounded-md mb-4 space-y-2" role="alert">
                        <p class="font-bold">VigenÃ¨re Cipher Keyword:</p>
                        <input type="text" id="vigenere-key-input" class="w-full p-2 border border-yellow-300 rounded-lg text-sm focus:ring-yellow-500 focus:border-yellow-500 uppercase" placeholder="Enter keyword (letters only)">
                    </div>

                    <!-- Actions -->
                    <div class="flex space-x-4">
                        <button onclick="performCrypto('encrypt')" class="flex-1 px-6 py-3 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition duration-150 ease-in-out">
                            Encrypt
                        </button>
                        <button onclick="performCrypto('decrypt')" class="flex-1 px-6 py-3 bg-gray-200 text-gray-800 font-semibold rounded-lg shadow-md hover:bg-gray-300 transition duration-150 ease-in-out">
                            Decrypt
                        </button>
                    </div>
                </div>
            </section>

            <!-- Tab 2: Security Analysis (Password Strength) -->
            <section id="analysis-tab" class="tab-content space-y-6 hidden">
                <h2 class="text-2xl font-semibold text-gray-800 border-b pb-2 mb-4">Password Strength Analysis</h2>
                
                <div class="bg-blue-50 border-l-4 border-blue-500 text-blue-700 p-4 rounded-md" role="alert">
                    <p class="font-bold">Check your passwords!</p>
                    <p class="text-sm">Enter any password to get an instant analysis of its strength based on length and character diversity.</p>
                </div>

                <label for="strength-input" class="block text-sm font-medium text-gray-700 mb-2">Password to Analyze:</label>
                <input type="text" id="strength-input" onkeyup="checkPasswordStrength()" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-xl font-mono transition duration-150" placeholder="Type your password here...">

                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password Strength:</label>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="strength-meter" class="h-2 rounded-full transition-all duration-300" style="width: 0%;"></div>
                    </div>
                    <p id="strength-label" class="text-sm font-semibold mt-2 text-gray-500">Strength: Not Rated (0%)</p>
                </div>
            </section>


            <!-- Tab 3: Password Generator -->
            <section id="password-tab" class="tab-content space-y-6 hidden">
                <h2 class="text-2xl font-semibold text-gray-800 border-b pb-2 mb-4">AI Password Generator</h2>
                <div class="bg-blue-50 border-l-4 border-blue-500 text-blue-700 p-4 rounded-md" role="alert">
                    <p class="font-bold">How it works:</p>
                    <p class="text-sm">Enter an easy-to-remember phrase or a simple password you'd like to secure. Gemini will transform it into a highly secure, yet psychologically memorable passphrase.</p>
                </div>

                <label for="password-prompt" class="block text-sm font-medium text-gray-700 mb-2">Your Phrase/Password Idea:</label>
                <input type="text" id="password-prompt" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150" placeholder="e.g., 'ILoveMyCatBlinky' or 'MyBirthday1985'">

                <button id="generate-btn" onclick="generatePassword()" class="w-full px-6 py-3 bg-green-600 text-white font-semibold rounded-lg shadow-lg hover:bg-green-700 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed">
                    Generate Secure Password
                </button>

                <div id="password-loading" class="hidden text-center text-indigo-600 font-medium">
                    <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-indigo-600 inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    Generating highly secure passphrase...
                </div>

                <div class="mt-6">
                    <label for="password-output" class="block text-sm font-medium text-gray-700 mb-2">Generated Secure Password:</label>
                    <div class="relative">
                        <textarea id="password-output" rows="3" class="w-full p-3 border-2 border-green-500 rounded-lg bg-green-50 text-xl font-mono text-gray-800 resize-none" readonly placeholder="Your new password will appear here..."></textarea>
                        <button onclick="copyToClipboard('password-output')" class="absolute top-2 right-2 p-2 bg-green-600 text-white rounded-lg shadow hover:bg-green-700 transition duration-150">
                            Copy
                        </button>
                    </div>
                    <p id="copy-message" class="text-sm text-green-600 mt-2 hidden">Copied to clipboard!</p>
                </div>
                
                <p class="text-xs text-gray-500 mt-4 text-center">API Key is managed by the execution environment and is not visible to the user.</p>

            </section>

            <!-- Tab 4: Explainer AI -->
            <section id="explainer-tab" class="tab-content space-y-6 hidden">
                <h2 class="text-2xl font-semibold text-gray-800 border-b pb-2 mb-4">Security Concept Explainer (Gemini AI)</h2>
                
                <div class="bg-purple-50 border-l-4 border-purple-500 text-purple-700 p-4 rounded-md" role="alert">
                    <p class="font-bold">Secure-Bot is ready!</p>
                    <p class="text-sm">Ask about any security, crypto, or hacking concept (e.g., **"What is a zero-day attack?"** or **"Explain the Diffie-Hellman Key Exchange"**).</p>
                </div>

                <label for="explainer-prompt" class="block text-sm font-medium text-gray-700 mb-2">Concept to Explain:</label>
                <input type="text" id="explainer-prompt" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150" placeholder="e.g., 'What is a rainbow table?'">

                <button id="explain-btn" onclick="getSecurityExplanation()" class="w-full px-6 py-3 bg-purple-600 text-white font-semibold rounded-lg shadow-lg hover:bg-purple-700 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed">
                    Explain Concept
                </button>

                <div id="explainer-loading" class="hidden text-center text-purple-600 font-medium">
                    <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-purple-600 inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    Secure-Bot is researching and composing an answer...
                </div>

                <div class="mt-6">
                    <label for="explainer-output" class="block text-sm font-medium text-gray-700 mb-2">Explanation:</label>
                    <textarea id="explainer-output" rows="6" class="w-full p-3 border-2 border-purple-500 rounded-lg bg-purple-50 text-base text-gray-800 resize-none" readonly placeholder="Secure-Bot's explanation will appear here..."></textarea>
                </div>
            </section>

        </main>
    </div>

    <!-- JavaScript Logic -->
    <script>
        const API_KEY = ""; // Managed by environment
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${API_KEY}`;
        
        let currentTab = 'crypto';
        
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize tab display
            showTab(currentTab);
        });

        function showTab(tabName) {
            currentTab = tabName;
            
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            
            // Deactivate all tab buttons
            document.querySelectorAll('.tab-button').forEach(el => {
                el.classList.remove('text-indigo-600', 'border-indigo-600');
                el.classList.add('text-gray-500', 'border-transparent', 'hover:text-gray-700', 'hover:border-gray-300');
            });

            // Show the selected tab content
            document.getElementById(`${tabName}-tab`).classList.remove('hidden');
            
            // Activate the selected tab button
            const activeBtn = document.getElementById(`tab-${tabName}`);
            activeBtn.classList.add('text-indigo-600', 'border-indigo-600');
            activeBtn.classList.remove('text-gray-500', 'border-transparent', 'hover:text-gray-700', 'hover:border-gray-300');

            // Ensure correct controls are visible for the crypto tab
            if (tabName === 'crypto') {
                updateCipherControls();
            }
        }

        // --- Tab 1: Encryption/Decryption Logic (Ciphers) ---

        function rotCipher(text, shift, encrypt) {
            const finalShift = encrypt ? shift : (26 - (shift % 26)) % 26;

            return text.split('').map(char => {
                const charCode = char.charCodeAt(0);

                if (charCode >= 65 && charCode <= 90) { // Uppercase (A=65, Z=90)
                    return String.fromCharCode(((charCode - 65 + finalShift) % 26) + 65);
                } else if (charCode >= 97 && charCode <= 122) { // Lowercase (a=97, z=122)
                    return String.fromCharCode(((charCode - 97 + finalShift) % 26) + 97);
                }
                return char; // Non-alphabetic characters remain unchanged
            }).join('');
        }
        
        function vigenereCipher(text, keyword, mode) {
            const key = keyword.toUpperCase().replace(/[^A-Z]/g, '');
            if (!key) return "Error: Keyword must contain at least one letter.";
            
            let result = '';
            let keyIndex = 0;

            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                let charCode = char.charCodeAt(0);
                let base = 0;
                
                if (charCode >= 65 && charCode <= 90) { 
                    base = 65;
                } else if (charCode >= 97 && charCode <= 122) { 
                    base = 97;
                } else {
                    result += char; 
                    continue;
                }

                const keyShift = key.charCodeAt(keyIndex % key.length) - 65;
                let shift = keyShift;

                if (mode === 'decrypt') {
                    shift = (26 - keyShift) % 26;
                }
                
                const originalIndex = charCode - base;
                const newIndex = (originalIndex + shift) % 26;
                
                result += String.fromCharCode(newIndex + base);
                keyIndex++;
            }

            return result;
        }


        function base64Encode(text) {
            try {
                return btoa(text);
            } catch (e) {
                return `Error: ${e.message}`;
            }
        }

        function base64Decode(text) {
            try {
                return atob(text);
            } catch (e) {
                return 'Error: Invalid Base64 string.';
            }
        }

        function updateCipherControls() {
            const selectedCipher = document.querySelector('input[name="cipher"]:checked').value;
            document.getElementById('rot-control').classList.add('hidden');
            document.getElementById('vigenere-control').classList.add('hidden');
            // Rail Fence Control removed
            // document.getElementById('railfence-control').classList.add('hidden');

            if (selectedCipher === 'rot') {
                document.getElementById('rot-control').classList.remove('hidden');
            } else if (selectedCipher === 'vigenere') {
                document.getElementById('vigenere-control').classList.remove('hidden');
            }
        }

        async function performCrypto(mode) {
            const input = document.getElementById('crypto-input').value;
            const outputEl = document.getElementById('crypto-output');
            const selectedCipher = document.querySelector('input[name="cipher"]:checked').value;
            
            outputEl.value = '';

            if (selectedCipher === 'rot') {
                const shift = parseInt(document.getElementById('rot-shift').value, 10) || 13;
                outputEl.value = rotCipher(input, shift, mode === 'encrypt');
            } else if (selectedCipher === 'base64') {
                if (mode === 'encrypt') {
                    outputEl.value = base64Encode(input);
                } else {
                    outputEl.value = base64Decode(input);
                }
            } else if (selectedCipher === 'vigenere') {
                const keyword = document.getElementById('vigenere-key-input').value;
                if (!keyword.trim()) {
                    outputEl.value = "Error: Please enter a VigenÃ¨re keyword.";
                    return;
                }
                outputEl.value = vigenereCipher(input, keyword, mode);
            }
        }


        // --- Tab 2: Security Analysis (Password Strength) ---
        function checkPasswordStrength() {
            const password = document.getElementById('strength-input').value;
            const meter = document.getElementById('strength-meter');
            const label = document.getElementById('strength-label');

            if (password.length === 0) {
                meter.style.width = `0%`;
                meter.className = `h-2 rounded-full transition-all duration-300 bg-gray-200`;
                label.textContent = `Strength: Not Rated (0%)`;
                label.className = `text-sm font-semibold mt-2 text-gray-500`;
                return;
            }

            let score = 0;
            const minLength = 12;

            // 1. Length Bonus
            score += Math.min(30, password.length * 2.5);

            // 2. Character Set Bonuses
            const hasLower = /[a-z]/.test(password);
            const hasUpper = /[A-Z]/.test(password);
            const hasNumber = /\d/.test(password);
            const hasSymbol = /[^a-zA-Z0-9\s]/.test(password);

            if (hasLower) score += 10;
            if (hasUpper) score += 10;
            if (hasNumber) score += 15;
            if (hasSymbol) score += 15;

            // 3. Deduction for lack of diversity/length
            const charTypes = hasLower + hasUpper + hasNumber + hasSymbol;
            if (charTypes < 3 && password.length < minLength) score -= 10;
            if (password.length < 8) score -= 15; // Penalize very short passwords
            
            // Cap score at 100
            score = Math.min(100, Math.max(0, score));

            let strength = 'Very Weak';
            let color = 'bg-red-500';

            if (score > 85) { strength = 'Excellent'; color = 'bg-green-600'; }
            else if (score > 65) { strength = 'Strong'; color = 'bg-blue-500'; }
            else if (score > 45) { strength = 'Medium'; color = 'bg-yellow-500'; }
            else if (score > 25) { strength = 'Weak'; color = 'bg-orange-500'; }

            // Update UI
            meter.style.width = `${score}%`;
            meter.className = `h-2 rounded-full transition-all duration-300 ${color}`;
            label.textContent = `Strength: ${strength} (${score}%)`;
            label.className = `text-sm font-semibold mt-2 ${color.replace('bg-', 'text-')}`;
        }


        // --- Tab 3: Gemini Password Generator Logic ---

        async function generatePassword() {
            const userPrompt = document.getElementById('password-prompt').value.trim();
            const outputEl = document.getElementById('password-output');
            const generateBtn = document.getElementById('generate-btn');
            const loadingEl = document.getElementById('password-loading');
            
            if (!userPrompt) {
                outputEl.value = "Please enter a phrase or password idea for the AI to transform.";
                return;
            }

            // UI State: Loading
            generateBtn.disabled = true;
            generateBtn.textContent = 'Generating...';
            loadingEl.classList.remove('hidden');
            outputEl.value = '';
            document.getElementById('copy-message').classList.add('hidden');

            const systemPrompt = "You are a specialized security AI that helps users transform a simple or insecure password into a strong, easy-to-remember passphrase. Take the user's input (which might be an old password or a memory trigger) and create a new, long, complex, and secure password (at least 15 characters) that subtly incorporates elements of the original input, using common substitutions like 'a'->'@', 'o'->'0', 's'->'$'/'5', and adding random capitalization and digits. DO NOT explain your reasoning; just output the final password/passphrase and nothing else.";

            const payload = {
                contents: [{ parts: [{ text: `Transform this phrase/password idea into a secure passphrase: "${userPrompt}"` }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
            };

            let responseText = "Failed to generate password. Please check your connection or API configuration.";
            let maxRetries = 3;
            let delay = 1000;

            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (response.ok) {
                        const result = await response.json();
                        responseText = result.candidates?.[0]?.content?.parts?.[0]?.text?.trim() || "Generation failed: Empty response.";
                        break; // Success
                    } else if (response.status === 429) {
                        console.warn(`Rate limit hit. Retrying in ${delay / 1000}s...`);
                        await new Promise(resolve => setTimeout(resolve, delay));
                        delay *= 2; // Exponential backoff
                    } else {
                        // Handle non-retriable failure (e.g., 400, 403, 500)
                        const errorText = await response.text();
                        responseText = `API Failed (Status ${response.status} ${response.statusText}). See console for details.`;
                        console.error("Gemini API Error details:", errorText);
                        break; 
                    }
                } catch (error) {
                    responseText = `Network error occurred during API call. (${error.message})`;
                    console.error("Gemini API network error:", error);
                    break;
                }
            }

            // UI State: Complete
            outputEl.value = responseText;
            generateBtn.disabled = false;
            generateBtn.textContent = 'Generate Secure Password';
            loadingEl.classList.add('hidden');
        }

        // --- Tab 4: Explainer AI Logic ---

        async function getSecurityExplanation() {
            const userQuery = document.getElementById('explainer-prompt').value.trim();
            const outputEl = document.getElementById('explainer-output');
            const explainBtn = document.getElementById('explain-btn');
            const loadingEl = document.getElementById('explainer-loading');
            
            if (!userQuery) {
                outputEl.value = "Please enter a security concept to explain.";
                return;
            }

            // UI State: Loading
            explainBtn.disabled = true;
            explainBtn.textContent = 'Explaining...';
            loadingEl.classList.remove('hidden');
            outputEl.value = '';

            const systemPrompt = "You are a friendly and knowledgeable security tutor named 'Secure-Bot'. Explain complex security, hacking, or cryptography concepts clearly, concisely, and in a single paragraph, suitable for a general audience. Include key definitions and a brief note on associated risks or use cases. Maintain a professional yet encouraging tone.";

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
                tools: [{ "google_search": {} }],
            };

            let responseText = "Failed to generate explanation. Please check your connection or API configuration.";
            let maxRetries = 3;
            let delay = 1000;

            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (response.ok) {
                        const result = await response.json();
                        responseText = result.candidates?.[0]?.content?.parts?.[0]?.text?.trim() || "Generation failed: Empty response.";
                        break; // Success
                    } else if (response.status === 429) {
                        console.warn(`Rate limit hit. Retrying in ${delay / 1000}s...`);
                        await new Promise(resolve => setTimeout(resolve, delay));
                        delay *= 2; // Exponential backoff
                    } else {
                        const errorText = await response.text();
                        responseText = `API Failed (Status ${response.status} ${response.statusText}). See console for details.`;
                        console.error("Gemini API Error details:", errorText);
                        break; 
                    }
                } catch (error) {
                    responseText = `Network error occurred during API call. (${error.message})`;
                    console.error("Gemini API network error:", error);
                    break;
                }
            }

            // UI State: Complete
            outputEl.value = responseText;
            explainBtn.disabled = false;
            explainBtn.textContent = 'Explain Concept';
            loadingEl.classList.add('hidden');
        }

        // --- Utility Functions ---

        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            element.select();
            element.setSelectionRange(0, 99999); // For mobile devices

            // Use execCommand for broader support in iframe environments
            try {
                document.execCommand('copy');
                const msg = document.getElementById('copy-message');
                msg.classList.remove('hidden');
                setTimeout(() => msg.classList.add('hidden'), 2000);
            } catch (err) {
                console.error('Copy failed:', err);
                // Fallback for environments where execCommand is blocked
                element.value = 'Copy failed. Please manually copy the text.';
            }
        }
        
    </script>
</body>
</html>
